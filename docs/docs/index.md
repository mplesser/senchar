# Home

Senchar is python package used for characterization of scientific imaging sensors such as CCDs and CMOS imagers. It is based on, but independent from, the [azcam](https://azcam.readthedocs.io/) package developed at the University of Arizona [Imaging Technology Laboratory](https://www.itl.arizona.edu/).

## Installation

```shell
pip install senchar
```

## Classes

The common classes used thorughout senchar is listed here.

### Image Related Classes

A senchar image is described by the main `Image` class as well as the `Focalplane` and `WCS` classes. The `Focalplane` class defines all aspects of the focal plane and sensor configuration used to create an image. The `WCS` class defines the World Coorindate System paramaters for the image.

Usage Example:

```python
from senchar.image import Image
im1 = Image('test.fits')
```

[API documentation for Image related classes](api/image.md)

### Database Class

This class defines the `senchar.db` object. This is basically the global store of information which all senchar objects can access.

[API documentation for the Database](api/database.md)

### Header Class

Senchar uses object-specific keyword indexed dictionaries to maintain textual informational about the various tools. These are called headers as they are used to provide information for image headers. Most of the 
values are written to the image file header (such as a FITS header) when an exposure begins.

[API documentation for the Header class](api/header.md)

## Commands

These commands are available for user code development and are also extensively unsed internally. Programatically these are function calls and are not class or tool methods.

### FITS
The *senchar.fits* commands provide FITS image support functions.

Usage Example:

`senchar.fits.colbias("test.fits", 3)`

[API documentation for the FITS functions](api/fits.md)

### Utilities

The *senchar.utils* commands are general purpose functions used throughout senchar.

Usage Example:

`senchar.utils.curdir("/data")`

[API documentation for the utility functions](api/utils.md)

## Tools

Tools are class instances which do specific tasks such as determine quantum efficiency from a set of images (the *qe* tool). See the autogenerated API documents for the various tools in [Tools](api/tools/tools.md).

## Configuration Folders

There are two important folders which are defined by most environments:

  * *systemfolder* - the main folder where configuration code is located. It is often the root of the environment's python package.
  * *datafolder* - the root folder where data and parameters are saved. Write access is required. It is often similar to */data/sytemfolder*.

## Scripts
Scripts are functions contained in python code modules of the same name. They are often loaded automatically during enviroment configuration and can be found in the `db.scripts` dictionary. An example script to measure system pressures might be:

```python
plot_images("/data")
```

## Help
Senchar is most commonly used with IPython.  Help is then available by typing `?xxx`, `xxx?`, `xxx??` or `help(xxx)` where `xxx` is an senchar class, command, or object instance.

## Advanced concepts

### Versioning
The senchar can be found from `senchar.db.version` after importing senchar. 

### Conventions
 * Modules (files), objects, command names (methods) and attributes (parameters) are all lowercase.
 * Filenames should be specified with forward slash ('/') separators, even under MS Windows. If back slashes are needed, they must be doubled as in `c:\\data`.
 * Strings must be enclosed in quotation marks, as in `parameters.get_par("imageroot")`. Quotation marks must match ('imageroot" is not acceptable). A quotation mark may be included in a string by preceding it with a backslash, as `"I am Mike\'s dog"` to generate `"I am Mike's dog"`.
 * A common command syntax is like `tool.command(args)` where `tool` is the tool name (such as *bias*, *image*, *qe*) and `command()` is the command or class method. If `command()` uses arguments, they are specified as comma separated values of the appropriate type, such as `tool.command('ITL', 1.234, 45)`.

### Parameters
When enabled, parameters may be written and read from a parameter file with the `Parameters` class using methods like `get_par()` and `set_par`.

### Logging
The `senchar.log()` function should be used for message output instead of python's `print()` function. This is important due to the multithreading nature of senchar.  The output of the `log()` function is defined in code and is typically directed to both the console and a rotating log file.

The `log()` function supports levels which determine if the logged message should actually be displayed. If the level value is greater than or equal to the value of `senchar.db.verbosity` then the message string is displayed. The default level is 1 for both `verbosity` and the `log()` command. Higher verbosity settings are intended for more detailed debug information.

It is also possible to direct logging to a web application, a syslog handler, or other applications. See <https://loguru.readthedocs.io/en/stable/index.html> and the `senchar.logger.py` code.
 

## Links

  * [senchar documentation (this site)](https://senchar.readthedocs.io)
  * [GitHub repo](https://github.com/mplesser/senchar)

Useful external links include:
  
 * [IPython](https://ipython.org)
 * [Python programming language](https://www.python.org)
